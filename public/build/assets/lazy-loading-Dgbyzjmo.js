var e,s,t=Object.getOwnPropertyNames,r=(e={"assets/lazy-loading-Dgbyzjmo.js"(e,s){class t{constructor(e={}){this.options={rootMargin:"50px 0px",threshold:.1,enableImages:!0,enableCSS:!0,enableJS:!0,enableBackgroundImages:!0,retryAttempts:3,retryDelay:1e3,...e},this.observers=new Map,this.loadedResources=new Set,this.failedResources=new Set,this.retryCount=new Map,this.init()}init(){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>this.setupObservers()):this.setupObservers()}setupObservers(){this.options.enableImages&&this.setupImageObserver(),this.options.enableCSS&&this.setupCSSObserver(),this.options.enableJS&&this.setupJSObserver(),this.options.enableBackgroundImages&&this.setupBackgroundImageObserver()}setupImageObserver(){const e=new IntersectionObserver((e,s)=>{e.forEach(e=>{e.isIntersecting&&(this.loadImage(e.target),s.unobserve(e.target))})},{rootMargin:this.options.rootMargin,threshold:this.options.threshold});this.observers.set("images",e),document.querySelectorAll("img[data-src], img.lazy-image").forEach(s=>{e.observe(s)})}setupCSSObserver(){const e=new IntersectionObserver((e,s)=>{e.forEach(e=>{e.isIntersecting&&(this.loadCSS(e.target),s.unobserve(e.target))})},{rootMargin:this.options.rootMargin,threshold:this.options.threshold});this.observers.set("css",e),document.querySelectorAll("[data-lazy-css]").forEach(s=>{e.observe(s)})}setupJSObserver(){const e=new IntersectionObserver((e,s)=>{e.forEach(e=>{e.isIntersecting&&(this.loadJS(e.target),s.unobserve(e.target))})},{rootMargin:this.options.rootMargin,threshold:this.options.threshold});this.observers.set("js",e),document.querySelectorAll("[data-lazy-js]").forEach(s=>{e.observe(s)})}setupBackgroundImageObserver(){const e=new IntersectionObserver((e,s)=>{e.forEach(e=>{e.isIntersecting&&(this.loadBackgroundImage(e.target),s.unobserve(e.target))})},{rootMargin:this.options.rootMargin,threshold:this.options.threshold});this.observers.set("background",e),document.querySelectorAll("[data-bg-src]").forEach(s=>{e.observe(s)})}async loadImage(e){const s=e.dataset.src||e.src,t=e.dataset.fallback;if(!this.loadedResources.has(s)&&!this.failedResources.has(s))try{e.classList.add("loading");const r=new Image;await new Promise((o,a)=>{r.onload=()=>{e.src=s,e.classList.remove("loading"),e.classList.add("loaded"),this.loadedResources.add(s),o()},r.onerror=()=>{t?(e.src=t,e.classList.add("fallback")):e.classList.add("error"),e.classList.remove("loading"),this.failedResources.add(s),a(new Error(`Failed to load image: ${s}`))},r.src=s})}catch(r){this.handleRetry("image",s,()=>this.loadImage(e))}}async loadCSS(e){const s=e.dataset.lazyCss;if(!s)return;const t=s.split(",").map(e=>e.trim());for(const o of t)if(!this.loadedResources.has(o))try{await this.loadCSSFile(o),this.loadedResources.add(o)}catch(r){this.handleRetry("css",o,()=>this.loadCSSFile(o))}}async loadCSSFile(e){return new Promise((s,t)=>{if(document.querySelector(`link[href="${e}"]`))return void s();const r=document.createElement("link");r.rel="stylesheet",r.href=e,r.onload=s,r.onerror=t,document.head.appendChild(r)})}async loadJS(e){const s=e.dataset.lazyJs;if(!s)return;const t=s.split(",").map(e=>e.trim());for(const o of t)if(!this.loadedResources.has(o))try{await this.loadJSFile(o),this.loadedResources.add(o)}catch(r){this.handleRetry("js",o,()=>this.loadJSFile(o))}}async loadJSFile(e){return new Promise((s,t)=>{if(document.querySelector(`script[src="${e}"]`))return void s();const r=document.createElement("script");r.src=e,r.async=!0,r.onload=s,r.onerror=t,document.head.appendChild(r)})}async loadBackgroundImage(e){const s=e.dataset.bgSrc;if(s&&!this.loadedResources.has(s))try{const t=new Image;await new Promise((r,o)=>{t.onload=()=>{e.style.backgroundImage=`url(${s})`,e.classList.add("bg-loaded"),this.loadedResources.add(s),r()},t.onerror=o,t.src=s})}catch(t){this.handleRetry("background",s,()=>this.loadBackgroundImage(e))}}handleRetry(e,s,t){const r=`${e}:${s}`,o=this.retryCount.get(r)||0;o<this.options.retryAttempts&&(this.retryCount.set(r,o+1),setTimeout(t,this.options.retryDelay*(o+1)))}loadResourceImmediately(e,s="image"){switch(s){case"image":const s=document.querySelector(`img[data-src="${e}"]`);s&&this.loadImage(s);break;case"css":this.loadCSSFile(e);break;case"js":this.loadJSFile(e)}}preloadResource(e,s="image"){if(!this.loadedResources.has(e))switch(s){case"image":const s=document.createElement("link");s.rel="preload",s.as="image",s.href=e,document.head.appendChild(s);break;case"css":this.loadCSSFile(e);break;case"js":this.loadJSFile(e)}}destroy(){this.observers.forEach(e=>e.disconnect()),this.observers.clear()}}const r=new t({rootMargin:"100px 0px",threshold:.1,enableImages:!0,enableCSS:!0,enableJS:!0,enableBackgroundImages:!0,retryAttempts:2,retryDelay:1e3});window.LazyLoader=t,window.lazyLoader=r,window.performance&&window.performance.mark&&window.performance.mark("lazy-loader-init"),void 0!==s&&s.exports&&(s.exports=t)}},function(){return s||(0,e[t(e)[0]])((s={exports:{}}).exports,s),s.exports});export default r();
